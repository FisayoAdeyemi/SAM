Marine Wave Resource
1296
1156
23
Hyperlink

1
9
Name
5
10
Hyperlink2
X
3
27
Y
3
468
Width
3
847
Height
3
21
Tool Tip
5
0
Caption
5
137
For locations not covered by the wave resource library, click here to go to the SAM website Weather Page for links to other data sources.
URL
5
33
https://sam.nrel.gov/weather-data
TabOrder
3
0
Button

1
8
Name
5
14
btnScanLibrary
X
3
789
Y
3
27
Width
3
150
Height
3
24
Tool Tip
5
0
Caption
5
15
Refresh Library
TabOrder
3
4294967295
Label

1
13
Name
5
24
download_weather_caption
X
3
24
Y
3
360
Width
3
846
Height
3
43
Tool Tip
5
0
Caption
5
342
The High Resolution Ocean Surface Wave Hindcast is a database with 30  years of 3-hour resolution wave data that you can download and add to your wave resource library.  Download the joint probability distribution (JPD) file based on a specified year, a specified subset of a year, or the entire multi-year dataset for a particular location. 
TextColour
4
0
0
0
255
Bold
2
0
FontSize
3
4294967295
WordWrap
2
1
AlignRight
2
0
AlignTop
2
1
TextEntry

1
11
Name
5
9
file_name
X
3
279
Y
3
312
Width
3
960
Height
3
24
Tool Tip
5
0
Text
5
0
Editable
2
1
ForeColour
4
128
0
64
255
BackColour
4
255
255
255
255
TabOrder
3
4294967295
Numeric

1
17
Name
5
13
frequency_sum
X
3
1014
Y
3
1005
Width
3
90
Height
3
24
Tool Tip
5
0
Value
1
0
Mode
3
1
Format
3
1
Decimals
3
3
Prefix
5
0
Suffix
5
0
ThousandsSep
2
1
Editable
2
1
ForeColour
4
0
0
0
255
BackColour
4
255
255
255
255
TabOrder
3
4294967295
GroupBox

1
8
Name
5
13
group_library
X
3
12
Y
3
12
Width
3
1248
Height
3
331
Tool Tip
5
0
Caption
5
28
Wave Energy Resource Library
Bold
2
1
GroupBox

1
8
Name
5
17
group_wave_matrix
X
3
12
Y
3
516
Width
3
1270
Height
3
524
Tool Tip
5
0
Caption
5
57
Annual Frequency of Occurrence of Sea States from Library
Bold
2
1
TextEntry

1
11
Name
5
15
in_location_jpd
X
3
27
Y
3
441
Width
3
573
Height
3
24
Tool Tip
5
0
Text
5
77
Type the latitude and longitude of the desired wave energy converter location
Editable
2
1
ForeColour
4
0
0
0
255
BackColour
4
255
255
255
255
TabOrder
3
6
RadioChoice

1
11
Name
5
17
in_time_frame_jpd
X
3
33
Y
3
414
Width
3
403
Height
3
24
Tool Tip
5
0
Selection
3
0
Items
6
3
Entire year
Specified range
Entire dataset
ShowCaptions
2
1
Horizontal
2
1
TabOrder
3
8
Label

1
13
Name
5
13
label_library
X
3
15
Y
3
30
Width
3
764
Height
3
21
Tool Tip
5
0
Caption
5
128
Click a name in the list to choose a file from the library. Type a few letters of the name in the search box to filter the list.
TextColour
4
0
0
0
255
Bold
2
0
FontSize
3
4294967295
WordWrap
2
1
AlignRight
2
0
AlignTop
2
1
Library

1
8
Name
5
8
location
X
3
15
Y
3
57
Width
3
1223
Height
3
243
Tool Tip
5
0
Library
5
16
WaveResourceData
Fields
5
127
Name,City,State,Country,Latitude,Longitude,Nearby Buoy Number,Average Power Flux,Bathymetry,Sea Bed,Time Zone,Data Source,Notes
Numeric

1
17
Name
5
13
max_frequency
X
3
195
Y
3
1005
Width
3
103
Height
3
24
Tool Tip
5
0
Value
1
0
Mode
3
1
Format
3
1
Decimals
3
3
Prefix
5
0
Suffix
5
0
ThousandsSep
2
0
Editable
2
1
ForeColour
4
0
0
0
255
BackColour
4
255
255
255
255
TabOrder
3
9
Numeric

1
17
Name
5
16
max_frequency_Hs
X
3
456
Y
3
1005
Width
3
103
Height
3
24
Tool Tip
5
0
Value
1
0
Mode
3
1
Format
3
1
Decimals
3
3
Prefix
5
0
Suffix
5
0
ThousandsSep
2
0
Editable
2
1
ForeColour
4
0
0
0
255
BackColour
4
255
255
255
255
TabOrder
3
9
Numeric

1
17
Name
5
16
max_frequency_Te
X
3
771
Y
3
1005
Width
3
103
Height
3
24
Tool Tip
5
0
Value
1
0
Mode
3
1
Format
3
1
Decimals
3
3
Prefix
5
0
Suffix
5
0
ThousandsSep
2
0
Editable
2
1
ForeColour
4
0
0
0
255
BackColour
4
255
255
255
255
TabOrder
3
10
GroupBox

1
8
Name
5
8
object 4
X
3
12
Y
3
345
Width
3
1270
Height
3
162
Tool Tip
5
0
Caption
5
37
Download Marine Energy Resource Files
Bold
2
1
GroupBox

1
8
Name
5
10
object 418
X
3
6
Y
3
1050
Width
3
1269
Height
3
96
Tool Tip
5
0
Caption
5
25
Wave Energy Resource File
Bold
2
1
Label

1
13
Name
5
10
object 718
X
3
750
Y
3
1071
Width
3
496
Height
3
68
Tool Tip
5
0
Caption
5
251
Check the box and click Browse to choose a .csv file stored on your computer without adding it to the wave resource library. Note that the matrix data above shows data from files in the library, not from the file you choose here. See Help for details.
TextColour
4
0
0
0
255
Bold
2
0
FontSize
3
4294967295
WordWrap
2
1
AlignRight
2
0
AlignTop
2
1
Button

1
8
Name
5
14
select_wf_wave
X
3
651
Y
3
1101
Width
3
90
Height
3
24
Tool Tip
5
0
Caption
5
9
Browse...
TabOrder
3
4294967295
CheckBox

1
9
Name
5
20
use_specific_wf_wave
X
3
21
Y
3
1071
Width
3
501
Height
3
27
Tool Tip
5
0
Caption
5
65
Choose wave energy resource file instead of choosing from library
State
2
0
TabOrder
3
4294967295
TextEntry

1
11
Name
5
22
user_specified_wf_wave
X
3
21
Y
3
1101
Width
3
624
Height
3
24
Tool Tip
5
0
Text
5
0
Editable
2
1
ForeColour
4
0
0
0
255
BackColour
4
255
255
255
255
TabOrder
3
4294967295
Button

1
8
Name
5
13
wave_download
X
3
618
Y
3
441
Width
3
234
Height
3
24
Tool Tip
5
0
Caption
5
30
Download and add to library...
TabOrder
3
10
TextEntry

1
11
Name
5
22
wave_resource_filename
X
3
798
Y
3
402
Width
3
459
Height
3
24
Tool Tip
5
0
Text
5
0
Editable
2
1
ForeColour
4
0
0
0
255
BackColour
4
255
255
255
255
TabOrder
3
4294967295
DataMatrix

1
27
Name
5
20
wave_resource_matrix
X
3
33
Y
3
534
Width
3
1200
Height
3
464
Tool Tip
5
0
PasteAppendRows
2
0
PasteAppendCols
2
0
ShowButtons
2
0
ShowRows
2
0
ShowRowLabels
2
0
RowLabels
5
0
ShadeR0C0
2
1
VerticalLabel
5
32
Hs = significant wave height (m)
HorizontalLabel
5
27
Te = wave energy period (s)
ShadeC0
2
0
ShowCols
2
0
ShowColLabels
2
0
ColLabels
5
0
NumRowsLabel
5
5
Rows:
NumColsLabel
5
5
Cols:
Layout
3
1
ChoiceColumn
3
4294967295
Choices
5
15
Choice1,Choice2
HideColumn
3
4294967295
ShowColumn
3
4294967295
ColorMap
2
1

32
average_power_flux
3
1
Average power flux
kW/m
ME Wave Resource
0
8
1
1
1
1
0
Numeric
bathymetry
3
4
Bathymetry
 
ME Wave Resource
0
8
1
4
0
TextEntry
city
3
4
City
 
ME Wave Resource
0
8
1
4
0
TextEntry
country
3
4
Country
 
ME Wave Resource
0
8
1
4
0
TextEntry
data_source
3
4
Data source
 
ME Wave Resource
0
8
1
4
0
TextEntry
file_name
3
4
Wave resource file name from library
 
ME Wave Resource
0
8
1
4
0
TextEntry
frequency_sum
3
1
Frequency sum
%
ME Wave Resource
0
8
1
1
1
1
0
Numeric
in_location_jpd
3
0
 
 
 
0
0
1
0
Default
in_time_frame_jpd
3
1
 
 
 
0
0
1
1
1
1
0
Default
lat
3
1
Latitude
degrees
ME Wave Resource
0
8
1
1
1
1
0
Numeric
location
3
4
Wave resource location
 
ME Wave Resource
18
WaveResourceData|0
19
1
4
27
CalWave Central Coast South
Library
lon
3
1
Longitude
degrees 
ME Wave Resource
0
8
1
1
1
1
0
Numeric
max_frequency
3
1
Probability of dominant wave
 
ME Wave Resource
0
8
1
1
1
1
0
Numeric
max_frequency_Hs
3
1
Dominant wave height
m
ME Wave Resource
0
8
1
1
1
1
0
Numeric
max_frequency_Te
3
1
Dominant wave period
s
ME Wave Resource
0
8
1
1
1
1
0
Numeric
name
3
4
Name
 
ME Wave Resource
0
8
1
4
0
TextEntry
nearby_buoy_number
3
4
Nearby buoy number
 
ME Wave Resource
0
8
1
4
0
TextEntry
notes
3
4
Notes
 
ME Wave Resource
0
8
1
4
9
<invalid>
TextEntry
sea_bed
3
4
Sea bed
 
ME Wave Resource
0
8
1
4
0
TextEntry
state
3
4
State
 
ME Wave Resource
0
8
1
4
0
TextEntry
tz
3
1
Time zone
 
ME Wave Resource
0
8
1
1
1
1
0
Numeric
use_specific_wave_file
3
0
 
 
 
0
0
1
0
 
use_specific_wf_wave
3
1
Wind resource enable user-specified file
 
ME Wave Resource
0
5
1
1
1
1
0
CheckBox
user_specified_wave_file
3
0
 
 
 
0
0
1
0
Default
user_specified_wf_wave
3
4
Wave resource user-specified file name
 
ME Wave Resource
0
1
1
4
1
 
Default
wave_data_file_name
3
4
 
 
 
0
0
1
4
9
<invalid>
Default
wave_data_file_name_load
3
4
 
 
 
0
0
1
4
9
<invalid>
Default
wave_download
3
0
 
 
 
0
0
1
0
Default
wave_library_folder_list
3
2
 
 
 
0
0
1
2
1
1
0
Default
wave_resource_file
3
0
Wave file
 
Location and Resource
0
8
1
0
Default
wave_resource_filename
3
4
Wave resource file name
 
ME Wave Resource
0
9
1
4
0
Default
wave_resource_matrix
3
3
Wave resource matrix
 
ME Wave Resource
0
3
1
3
1
1
0
DataMatrix

821
equations{'wave_resource_filename'} = define() {
	if ( ${use_specific_wf_wave} ) return ${user_specified_wf_wave};
	else return ${file_name};
};

equations{'wave_resource_file'} = define() {
	return ${wave_resource_filename};
};

equations{ '$MIMO$ mhk_wave_resource_freq' } = define () {
	mat = ${wave_resource_matrix};
	
	max_Hs = 0;
	max_Te = 0;
	max_freq = 0;
	for (r=1;r<#mat; r++)
		for (c=1; c<#mat[0];c++)
			if (mat[r][c] > max_freq)
			{
				max_freq =mat[r][c];
				max_Hs = mat[r][0];
				max_Te = mat[0][c];
			}
	${max_frequency} = max_freq;
	${max_frequency_Hs} = max_Hs;
	${max_frequency_Te} = max_Te;
	
	return 0;
};


equations{ 'frequency_sum' } = define () 
{
	mat = ${wave_resource_matrix};
	sum_mat = 0;
	for (r=1;r<#mat; r++)
		for (c=1; c<#mat[0];c++)
			sum_mat += mat[r][c];
	return sum_mat;
};

7846
function enable_disable_library() {
	enable_library = !value('use_specific_wf_wave');
	enable('wave_resource_matrix',false);
	property('wave_resource_matrix','ColorMap',enable_library);
	enable('location',enable_library);
	enable('btnScanLibrary',enable_library);
	enable('average_power_flux',enable_library);
	enable('bathymetry',enable_library);
	enable('city',enable_library);
	enable('country',enable_library);
	enable('data_source',enable_library);
	enable('file_name',enable_library);
	enable('frequency_sum',enable_library);
	enable('lat',enable_library);
	enable('location',enable_library);
	enable('lon',enable_library);
	enable('max_frequency',enable_library);
	enable('max_frequency_Hs',enable_library);
	enable('max_frequency_Te',enable_library);
	enable('name',enable_library);
	enable('nearby_buoy_number',enable_library);
	enable('notes',enable_library);
	enable('sea_bed',enable_library);
	enable('state',enable_library);
	enable('tz',enable_library);
	//enable('in_time_frame',enable_library);
	//enable('in_location',enable_library);
	//enable('wave_download',enable_library);
	
}

on_change{'btnScanLibrary'} = define() {
	rescanlibrary('wave');
	//update_info('on_change btnScanLibrary');

};


on_load{'Marine Wave Resource'} = define() {
	enable("wave_resource_matrix",false);
	on_change{'use_specific_wf_wave'}();
	enable_disable_library();
	//show('use_specific_wave_file', false); // determines whether user_specified_weather_file is used instead of solar_data_file_name
	//show('user_specified_wave_file', false); // requires use_specific_weather_file = 1, set by LK script
	//value('wave_data_file_name_load', value('wave_data_file_name'));
	//show('wave_data_file_name_load', false); // stores weather file name when UI form loaded
	//show('wave_data_file_name', false); 
	//show('in_time_frame', value('in_wave_options') != 0 ); //No option for TMY data on first iteraiton
	
	//refresh();
	//update_library_folders( '' );
	//update_info( 'on_load Wave Resource Data');
	//update_info( 'on_load Wave Resource Data');
};

on_change{'location'} = define() {
	file = ${file_name};
	value("name",value("location"));
	
	if (!file_exists(file))
	{
		rescanlibrary( 'wave' );
		refresh('location');
		return;
	}
	file = replace(file, '\\', '/');
	fn = open(file,'r');

	close(fn);
	//update_info('on_change location');
};

on_change{'use_specific_wf_wave'} = define() {
	enable( 'user_specified_wf_wave', ${use_specific_wf_wave} );
	enable( 'select_wf_wind', ${use_specific_wf_wave} );
	enable_disable_library();
};

on_change{'select_wf_wave'} = define() {
	file = choose_file( path_only( value('user_specified_wf_wave') ), 'Choose a wave resource file', 
		'Wave Resource Files (*.csv|*.csv');
		
	if ( file != '' ) {
		file = replace(file, '\\', '/');
		value( 'user_specified_wf_wave', file );
	}
};

function update_info( ctxt )
{
	wf = value('wave_resource_filename'); 
	L = strlen( value( 'wave_library_folder_list' ) );
	/*msgbox('Hello from update_info() in ' + ctxt + '!\nsolar_resource_file = ' + value('solar_resource_file')
	       + '\nsolar_data_file_name = ' + value('solar_data_file_name')
	       + '\n\nsolar_data_file_name_load = ' + value('solar_data_file_name_load')  
	       + '\n\nuser_specified_weather_file = ' + value('user_specified_weather_file')
	       + '\n\nfile_name = ' + value('file_name') 
	       + '\n\nsolar_resource = ' + value('solar_resource') 
	       + '\n\nwf is in library = ' + wave_library(value('solar_resource_file'),false){'is_in_library'}
	       + '\n\ncurrent selection is in library = ' + wave_library(value('solar_resource'),true){'is_in_library'} );*/
	
	//if selected library file is no longer in library reload library, and exit
	wf_ok = false;
	if (!file_exists(wf) )
	{
		msg_caption = 'Weather file does not exist. Please choose or download a different file above.';
		msg_color = 'red';
		show_button = false;
		rescanlibrary('wave'); // remove deleted file from library
	}
	// display message depending on whether file is in library or is a user-specified file
	elseif ( wf != value('file_name') )
	{
		msg_caption = 'The weather file is different from the file selected in the library because it was modified by an LK script. Click Add File to Library if you want the file to appear in the library list above.';
		msg_color = 'red';
		show_button = true;
	}
	elseif ( strlen( value( 'library_folder_list' ) ) < L ) // ** this check should never be true, right???
	{
		msg_caption = 'Weather file folder not in list? Please choose or download a different file above, or click Add file to library.';
		msg_color = 'red';
		show_button = true;
	}
	elseif ( !wave_library(slash_back_to_forward(value('location_ts')),true){'is_in_library'} )
	{
		msg_caption = 'Weather file is not in library. Please choose or download a different file above, or click Add file to library.';
		msg_color = 'red';
		show_button = true;
	}
	else
	{
		msg_caption = 'The following information describes the data in the highlighted weather file from the Solar Resource library above. This is the file SAM will use when you click Simulate.';
		msg_color = 'black';
		show_button = false;
		wf_ok = true;
	}

	// show / hide PV only summary data

	// display message for new users if library contains only default files
	

	// calculate and display annual summary data
	if ( wf_ok )
	{
		obj = ssc_create();
		ssc_var( obj, "wave_resource_model_choice", 0);
		ssc_var( obj, "wave_resource_filename", value('wave_resource_filename'));
		result = ssc_exec( obj, 'wave_file_reader' );
		if ( 0 == result )
		{
			value( 'name_', ssc_var(obj, 'name') );
			value( 'city', ssc_var(obj, 'city') );
			value( 'state', ssc_var(obj, 'state') );
			value( 'country', ssc_var(obj, 'country') );
			value( 'lat', ssc_var(obj, 'lat') );
			value( 'lon', ssc_var(obj, 'lon') );
			value( 'nearby_buoy_number', ssc_var(obj, 'nearby_buoy_number') );
			//value( 'wave_significant_height', ssc_var(obj, 'wave_significant_height') );
			//value( 'wave_energy_period', ssc_var(obj, 'wave_energy_period') );
			// used for timestep calculation in editscene3d
			//alue( 'number_records', ssc_var(obj, 'number_records') );
			//value( 'number_hours', ssc_var(obj, 'number_hours') );
			value( 'wave_resource_matrix', ssc_var(obj, 'wave_resource_matrix'));
		}
		else
		{
			msgbox('Weather file reader failed!\n' 
			+ result
			+ '\n\nTo avoid this message, remove  the following file from your weather file folders: \n' + wf);
			//value( 'wave_significant_height', nan() );
			//value( 'wave_energy_period', nan() );
			//value( 'number_records', 0);
			//value( 'number_hours', 0);
			
		}
		ssc_free( obj );
	}
	
	if ( librarygetcurrentselection('location') == '' )
	{
		librarynotifytext('location','Please choose a file. Nothing selected.');
	}
	elseif ( !wave_library(slash_back_to_forward(value('location_ts')),true){'is_in_library'} ) 
	{
		librarynotifytext('location', 'Please choose a file. Current selection not in library.');
	}
	elseif (librarygetnumbermatches('location') < 1)
	{
		value('in_location', librarygetfiltertext('location_ts'));
		librarynotifytext('location', 'No match found. Try downloading a weather file below.');
	}
	elseif ( librarygetcurrentselection('location_ts') != file_to_key( value('wave_resource_filename_ts')) )
	{
		librarynotifytext('location','Current selection is different from weather file.');
	}
	else
	{
		librarynotifytext('location', ''); //'Everything is fine.'
		value('in_location_jpd', 'Type a location name, street address, or lat,lon in decimal degrees');
	}
	
	//msgbox('libraryget functions'+
	//'\nfiltertext = ' + librarygetfiltertext('solar_resource') 
	//+ '\nnumber matches = ' + librarygetnumbermatches('solar_resource') 
	//+ '\ncurrentselection = ' + librarygetcurrentselection('solar_resource'));
	
	//display_tech_message();
}






