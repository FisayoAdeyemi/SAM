ETES System Control
840
386
25
GroupBox

1
8
Name
5
9
GroupBox1
X
3
6
Y
3
9
Width
3
830
Height
3
101
Tool Tip
5
0
Caption
5
24
Plant Energy Consumption
Bold
2
1
Label

1
13
Name
5
6
Label1
X
3
390
Y
3
54
Width
3
56
Height
3
21
Tool Tip
5
0
Caption
5
6
Factor
TextColour
4
0
0
0
255
Bold
2
0
FontSize
3
0
WordWrap
2
0
AlignRight
2
0
AlignTop
2
0
Label

1
13
Name
5
7
Label11
X
3
447
Y
3
54
Width
3
56
Height
3
21
Tool Tip
5
0
Caption
5
7
Coeff 0
TextColour
4
0
0
0
255
Bold
2
0
FontSize
3
0
WordWrap
2
0
AlignRight
2
0
AlignTop
2
0
Label

1
13
Name
5
8
Label111
X
3
504
Y
3
54
Width
3
56
Height
3
21
Tool Tip
5
0
Caption
5
7
Coeff 1
TextColour
4
0
0
0
255
Bold
2
0
FontSize
3
0
WordWrap
2
0
AlignRight
2
0
AlignTop
2
0
Label

1
13
Name
5
9
Label1111
X
3
561
Y
3
54
Width
3
56
Height
3
21
Tool Tip
5
0
Caption
5
7
Coeff 2
TextColour
4
0
0
0
255
Bold
2
0
FontSize
3
0
WordWrap
2
0
AlignRight
2
0
AlignTop
2
0
LossAdjustment

1
7
Name
5
6
adjust
X
3
429
Y
3
138
Width
3
276
Height
3
67
Tool Tip
5
0
TabOrder
3
4294967295
Numeric

1
17
Name
5
7
bop_par
X
3
195
Y
3
78
Width
3
100
Height
3
21
Tool Tip
5
0
Value
1
0
Mode
3
1
Format
3
1
Decimals
3
3
Prefix
5
0
Suffix
5
0
ThousandsSep
2
0
Editable
2
1
ForeColour
4
0
0
0
255
BackColour
4
255
255
255
255
TabOrder
3
2
Numeric

1
17
Name
5
9
bop_par_0
X
3
447
Y
3
78
Width
3
55
Height
3
21
Tool Tip
5
0
Value
1
0
Mode
3
1
Format
3
1
Decimals
3
3
Prefix
5
0
Suffix
5
0
ThousandsSep
2
0
Editable
2
1
ForeColour
4
0
0
0
255
BackColour
4
255
255
255
255
TabOrder
3
4
Numeric

1
17
Name
5
9
bop_par_1
X
3
504
Y
3
78
Width
3
55
Height
3
21
Tool Tip
5
0
Value
1
0
Mode
3
1
Format
3
1
Decimals
3
3
Prefix
5
0
Suffix
5
0
ThousandsSep
2
0
Editable
2
1
ForeColour
4
0
0
0
255
BackColour
4
255
255
255
255
TabOrder
3
5
Numeric

1
17
Name
5
9
bop_par_2
X
3
561
Y
3
78
Width
3
55
Height
3
21
Tool Tip
5
0
Value
1
0
Mode
3
1
Format
3
1
Decimals
3
3
Prefix
5
0
Suffix
5
0
ThousandsSep
2
0
Editable
2
1
ForeColour
4
0
0
0
255
BackColour
4
255
255
255
255
TabOrder
3
6
Numeric

1
17
Name
5
9
bop_par_f
X
3
390
Y
3
78
Width
3
55
Height
3
21
Tool Tip
5
0
Value
1
0
Mode
3
1
Format
3
1
Decimals
3
3
Prefix
5
0
Suffix
5
0
ThousandsSep
2
0
Editable
2
1
ForeColour
4
0
0
0
255
BackColour
4
255
255
255
255
TabOrder
3
3
Numeric

1
17
Name
5
13
disp_csu_cost
X
3
258
Y
3
318
Width
3
100
Height
3
21
Tool Tip
5
0
Value
1
0
Mode
3
1
Format
3
1
Decimals
3
3
Prefix
5
0
Suffix
5
0
ThousandsSep
2
1
Editable
2
1
ForeColour
4
0
0
0
255
BackColour
4
255
255
255
255
TabOrder
3
9
Numeric

1
17
Name
5
14
disp_frequency
X
3
258
Y
3
294
Width
3
100
Height
3
21
Tool Tip
5
0
Value
1
0
Mode
3
1
Format
3
1
Decimals
3
3
Prefix
5
0
Suffix
5
0
ThousandsSep
2
1
Editable
2
1
ForeColour
4
0
0
0
255
BackColour
4
255
255
255
255
TabOrder
3
8
Numeric

1
17
Name
5
12
disp_horizon
X
3
258
Y
3
270
Width
3
100
Height
3
21
Tool Tip
5
0
Value
1
0
Mode
3
1
Format
3
1
Decimals
3
3
Prefix
5
0
Suffix
5
0
ThousandsSep
2
1
Editable
2
1
ForeColour
4
0
0
0
255
BackColour
4
255
255
255
255
TabOrder
3
7
Numeric

1
17
Name
5
13
disp_max_iter
X
3
702
Y
3
294
Width
3
100
Height
3
21
Tool Tip
5
0
Value
1
0
Mode
3
1
Format
3
1
Decimals
3
3
Prefix
5
0
Suffix
5
0
ThousandsSep
2
1
Editable
2
1
ForeColour
4
0
0
0
255
BackColour
4
255
255
255
255
TabOrder
3
14
Numeric

1
17
Name
5
12
disp_mip_gap
X
3
702
Y
3
318
Width
3
100
Height
3
21
Tool Tip
5
0
Value
1
0
Mode
3
1
Format
3
1
Decimals
3
3
Prefix
5
0
Suffix
5
0
ThousandsSep
2
1
Editable
2
1
ForeColour
4
0
0
0
255
BackColour
4
255
255
255
255
TabOrder
3
15
Numeric

1
17
Name
5
16
disp_pen_delta_w
X
3
258
Y
3
342
Width
3
100
Height
3
21
Tool Tip
5
0
Value
1
0
Mode
3
1
Format
3
1
Decimals
3
3
Prefix
5
0
Suffix
5
0
ThousandsSep
2
1
Editable
2
1
ForeColour
4
0
0
0
255
BackColour
4
255
255
255
255
TabOrder
3
11
Numeric

1
17
Name
5
19
disp_time_weighting
X
3
702
Y
3
270
Width
3
100
Height
3
21
Tool Tip
5
0
Value
1
0
Mode
3
1
Format
3
1
Decimals
3
3
Prefix
5
0
Suffix
5
0
ThousandsSep
2
1
Editable
2
1
ForeColour
4
0
0
0
255
BackColour
4
255
255
255
255
TabOrder
3
12
Numeric

1
17
Name
5
12
disp_timeout
X
3
702
Y
3
342
Width
3
100
Height
3
21
Tool Tip
5
0
Value
1
0
Mode
3
1
Format
3
1
Decimals
3
3
Prefix
5
0
Suffix
5
0
ThousandsSep
2
1
Editable
2
1
ForeColour
4
0
0
0
255
BackColour
4
255
255
255
255
TabOrder
3
16
Numeric

1
17
Name
5
17
etes_bop_des_calc
X
3
672
Y
3
78
Width
3
100
Height
3
21
Tool Tip
5
0
Value
1
0
Mode
3
1
Format
3
0
Decimals
3
1
Prefix
5
0
Suffix
5
0
ThousandsSep
2
0
Editable
2
1
ForeColour
4
0
0
0
255
BackColour
4
255
255
255
255
TabOrder
3
16
CheckBox

1
9
Name
5
11
is_dispatch
X
3
342
Y
3
243
Width
3
24
Height
3
21
Tool Tip
5
0
Caption
5
0
State
2
0
TabOrder
3
4294967295
GroupBox

1
8
Name
5
8
object 4
X
3
6
Y
3
222
Width
3
830
Height
3
156
Tool Tip
5
0
Caption
5
21
Dispatch Optimization
Bold
2
1
GroupBox

1
8
Name
5
10
object 418
X
3
6
Y
3
120
Width
3
830
Height
3
93
Tool Tip
5
0
Caption
5
19
System Availability
Bold
2
1
Label

1
13
Name
5
8
object 7
X
3
36
Y
3
141
Width
3
339
Height
3
69
Tool Tip
5
0
Caption
5
96
System availability losses reduce the system output to represent system outages or other events.
TextColour
4
0
0
0
255
Bold
2
0
FontSize
3
0
WordWrap
2
1
AlignRight
2
0
AlignTop
2
1
Numeric

1
17
Name
5
12
pb_fixed_par
X
3
342
Y
3
27
Width
3
100
Height
3
21
Tool Tip
5
0
Value
1
0
Mode
3
1
Format
3
1
Decimals
3
3
Prefix
5
0
Suffix
5
0
ThousandsSep
2
0
Editable
2
1
ForeColour
4
0
0
0
255
BackColour
4
255
255
255
255
TabOrder
3
1

17
adjust
3
5
Performance adjustment factors
 
System Control
0
1
1
5
1
0
LossAdjustment
bop_par
3
1
Balance of plant parasitic
MWe/MWcap
System Control
0
0
1
1
1
1
0.025
Default
bop_par_0
3
1
 
 
System Control
0
0
1
1
1
1
0
Numeric
bop_par_1
3
1
 
 
System Control
0
0
1
1
1
1
0.483
Default
bop_par_2
3
1
 
 
System Control
0
0
1
1
1
1
0
Default
bop_par_f
3
1
 
 
System Control
0
0
1
1
1
1
1
Default
disp_csu_cost
3
1
Cycle startup cost penalty
$/start
System Control
0
2
1
1
1
1
10000
Default
disp_frequency
3
1
Frequency for dispatch reoptimization
hour
System Control
0
2
1
1
1
1
24
Default
disp_horizon
3
1
Time horizon for dispatch optimization
hour
System Control
0
2
1
1
1
1
48
Default
disp_max_iter
3
1
Maximum branch and bound iterations
 
System Control
0
2
1
1
1
1
10000
Default
disp_mip_gap
3
1
Solution optimality gap tolerance
 
System Control
0
2
1
1
1
1
0.055
Default
disp_pen_delta_w
3
1
Power generation ramping penalty
$/Î”kWe
System Control
0
2
1
1
1
1
0.1
Default
disp_time_weighting
3
1
Objective function time weighting exponent
 
System Control
0
2
1
1
1
1
0.99
Default
disp_timeout
3
1
Optimization solver timeout limit
sec
System Control
0
2
1
1
1
1
5
Default
etes_bop_des_calc
3
1
BOP
MWe
System Control
0
8
1
1
1
1
0
Default
is_dispatch
3
1
Enable dispatch optimization
 
System Control
0
2
1
1
1
1
0
Default
pb_fixed_par
3
1
Fraction of rated gross power consumed all times
MWe/MWcap
System Control
0
2
1
1
1
1
0.0055
Default

6350
equations{ '$MIMO$ ui_etes_system_control__etes_cmod' } = define()
{
	obj = ssc_create();
	ssc_var(obj, "sim_type", 2);
	
	ssc_var(obj, "adjust:constant", ${adjust}{'constant'});
	
	ssc_var(obj, "solar_resource_file", ${solar_resource_file});
	
	ssc_var(obj, "T_htf_cold_des", ${T_htf_cold_des});
	ssc_var(obj, "T_htf_hot_des", ${T_htf_hot_des});
	ssc_var(obj, "P_ref", ${P_ref});
	ssc_var(obj, "design_eff", ${design_eff});
	ssc_var(obj, "tshours", ${tshours});
	ssc_var(obj, "heater_mult", ${heater_mult});
	ssc_var(obj, "gross_net_conversion_factor", ${gross_net_conversion_factor});
	
	ssc_var(obj, "pc_config", ${pc_config});
	ssc_var(obj, "pb_pump_coef", ${pb_pump_coef});
	ssc_var(obj, "startup_time", ${startup_time});                  
	ssc_var(obj, "startup_frac", ${startup_frac});
	ssc_var(obj, "cycle_max_frac", ${cycle_max_frac});
	ssc_var(obj, "cycle_cutoff_frac", ${cycle_cutoff_frac});
	ssc_var(obj, "q_sby_frac", ${q_sby_frac});

	ssc_var(obj, "dT_cw_ref", ${dT_cw_ref});       
	ssc_var(obj, "T_amb_des", ${T_amb_des});         
	ssc_var(obj, "P_boil", ${P_boil});         
	ssc_var(obj, "CT", ${CT});               
	ssc_var(obj, "T_approach", ${T_approach});                    
	ssc_var(obj, "T_ITD_des", ${T_ITD_des});       
	ssc_var(obj, "P_cond_ratio", ${P_cond_ratio});         
	ssc_var(obj, "pb_bd_frac", ${pb_bd_frac});   
	ssc_var(obj, "P_cond_min", ${P_cond_min});       
	ssc_var(obj, "n_pl_inc", ${n_pl_inc});       
	ssc_var(obj, "tech_type", ${tech_type});           

	ssc_var(obj, "ud_f_W_dot_cool_des", ${ud_f_W_dot_cool_des});         
	ssc_var(obj, "ud_m_dot_water_cool_des", ${ud_m_dot_water_cool_des});
	ssc_var(obj, "ud_ind_od", ${ud_ind_od});

	ssc_var(obj, "hot_htf_code", ${hot_htf_code});         
	ssc_var(obj, "ud_hot_htf_props", ${ud_hot_htf_props});   
	ssc_var(obj, "tes_init_hot_htf_percent", ${tes_init_hot_htf_percent});
	ssc_var(obj, "h_tank", ${h_tank});
	ssc_var(obj, "cold_tank_max_heat", ${cold_tank_max_heat});
	ssc_var(obj, "u_tank", ${u_tank});
	ssc_var(obj, "tank_pairs", ${tank_pairs});               
	ssc_var(obj, "cold_tank_Thtr", ${cold_tank_Thtr});       
	ssc_var(obj, "h_tank_min", ${h_tank_min});
	ssc_var(obj, "hot_tank_Thtr", ${hot_tank_Thtr});       
	ssc_var(obj, "hot_tank_max_heat", ${hot_tank_max_heat}); 

	ssc_var(obj, "f_q_dot_des_allowable_su", ${f_q_dot_des_allowable_su});
	ssc_var(obj, "hrs_startup_at_max_rate", ${hrs_startup_at_max_rate});

	ssc_var(obj, "is_dispatch", ${is_dispatch});
	ssc_var(obj, "disp_csu_cost", ${disp_csu_cost});
	ssc_var(obj, "disp_frequency", ${disp_frequency});
	ssc_var(obj, "disp_horizon", ${disp_horizon});
	ssc_var(obj, "disp_max_iter", ${disp_max_iter});
	ssc_var(obj, "disp_mip_gap", ${disp_mip_gap});
	ssc_var(obj, "disp_pen_delta_w", ${disp_pen_delta_w});
	ssc_var(obj, "disp_time_weighting", ${disp_time_weighting});
	ssc_var(obj, "disp_timeout", ${disp_timeout});

	ssc_var(obj, "pb_fixed_par", ${pb_fixed_par});     
	ssc_var(obj, "bop_par", ${bop_par});   
	ssc_var(obj, "bop_par_f", ${bop_par_f});             
	ssc_var(obj, "bop_par_0", ${bop_par_0});         
	ssc_var(obj, "bop_par_1", ${bop_par_1});         
	ssc_var(obj, "bop_par_2", ${bop_par_2});         

	if(financing() == "Single Owner"){
	ssc_var(obj, "ppa_multiplier_model", ${ppa_multiplier_model});         
	ssc_var(obj, "dispatch_factors_ts", ${dispatch_factors_ts});
	ssc_var(obj, "dispatch_sched_weekday", ${dispatch_sched_weekday});
	ssc_var(obj, "dispatch_sched_weekend", ${dispatch_sched_weekend});
	ssc_var(obj, "dispatch_factor1", ${dispatch_factor1});
	ssc_var(obj, "dispatch_factor2", ${dispatch_factor2});
	ssc_var(obj, "dispatch_factor3", ${dispatch_factor3});
	ssc_var(obj, "dispatch_factor4", ${dispatch_factor4});
	ssc_var(obj, "dispatch_factor5", ${dispatch_factor5});
	ssc_var(obj, "dispatch_factor6", ${dispatch_factor6});
	ssc_var(obj, "dispatch_factor7", ${dispatch_factor7});
	ssc_var(obj, "dispatch_factor8", ${dispatch_factor8});
	ssc_var(obj, "dispatch_factor9", ${dispatch_factor9}); 
	}

	ssc_var(obj, "cycle_spec_cost", ${cycle_spec_cost});
	ssc_var(obj, "tes_spec_cost", ${tes_spec_cost});
	ssc_var(obj, "heater_spec_cost", ${heater_spec_cost});     
	ssc_var(obj, "bop_spec_cost", ${bop_spec_cost});
	ssc_var(obj, "contingency_rate", ${contingency_rate}); 
	ssc_var(obj, "sales_tax_frac", ${sales_tax_frac});
	ssc_var(obj, "epc_cost_perc_of_direct", ${epc_cost_perc_of_direct});
	ssc_var(obj, "epc_cost_per_watt", ${epc_cost_per_watt});
	ssc_var(obj, "epc_cost_fixed", ${epc_cost_fixed});
	ssc_var(obj, "land_cost_perc_of_direct", ${land_cost_perc_of_direct});
	ssc_var(obj, "land_cost_per_watt", ${land_cost_per_watt});
	ssc_var(obj, "land_cost_fixed", ${land_cost_fixed});

	ssc_var(obj, "sales_tax_rate", ${sales_tax_rate});

	ssc_var(obj, "const_per_interest_rate1", ${const_per_interest_rate1});    
	ssc_var(obj, "const_per_interest_rate2", ${const_per_interest_rate2});
	ssc_var(obj, "const_per_interest_rate3", ${const_per_interest_rate3});
	ssc_var(obj, "const_per_interest_rate4", ${const_per_interest_rate4});
	ssc_var(obj, "const_per_interest_rate5", ${const_per_interest_rate5});
	ssc_var(obj, "const_per_months1", ${const_per_months1});
	ssc_var(obj, "const_per_months2", ${const_per_months2});
	ssc_var(obj, "const_per_months3", ${const_per_months3});
	ssc_var(obj, "const_per_months4", ${const_per_months4});
	ssc_var(obj, "const_per_months5", ${const_per_months5});
	ssc_var(obj, "const_per_percent1", ${const_per_percent1});
	ssc_var(obj, "const_per_percent2", ${const_per_percent2});
	ssc_var(obj, "const_per_percent3", ${const_per_percent3});
	ssc_var(obj, "const_per_percent4", ${const_per_percent4});
	ssc_var(obj, "const_per_percent5", ${const_per_percent5});
	ssc_var(obj, "const_per_upfront_rate1", ${const_per_upfront_rate1});       
	ssc_var(obj, "const_per_upfront_rate2", ${const_per_upfront_rate2});       
	ssc_var(obj, "const_per_upfront_rate3", ${const_per_upfront_rate3});       
	ssc_var(obj, "const_per_upfront_rate4", ${const_per_upfront_rate4});       
	ssc_var(obj, "const_per_upfront_rate5", ${const_per_upfront_rate5});       

	ret_d = ssc_dump(obj, 'etes_system_des_mimo.txt');

	ret = ssc_exec(obj, 'etes_electric_resistance');

	if(ret==0) {
		${etes_bop_des_calc} = ssc_var(obj, "W_dot_bop_design");
	}
	else {
		vf = -789;
		${etes_bop_des_calc} = vf;
	}
	
	ssc_free( obj );
};
621
on_load{"ETES System Control"} = define()
{
	on_change{"is_dispatch"}();
};

on_change{"is_dispatch"} = define() {
     en = value("is_dispatch");
     
     enable("disp_horizon", en==1);
     enable("disp_frequency", en==1);
     enable("disp_max_iter", en==1);
     enable("disp_timeout", en==1);
     enable("disp_mip_gap", en==1);
     enable("disp_csu_cost", en==1);
     enable("disp_rsu_cost", en==1);
     enable("disp_pen_delta_w", en==1);
     enable("disp_wlim_max", en==1);
     enable("disp_wlim_maxspec", en==1);
     enable("disp_time_weighting", en==1);
     enable("disp_inventory_incentive", en==1);
};